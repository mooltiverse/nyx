/*------------------------------------------------------------------------------
  Plugins DSL block
  https://docs.gradle.org/current/userguide/plugins.html#sec:plugins_block
------------------------------------------------------------------------------*/
plugins {
    // Builds a dependency tree of Gradle tasks, i.e. './gradlew <task> taskTree'
    // This plugin can be commented out and used only when needed.
    // See: https://github.com/dorongold/gradle-task-tree
    id "com.dorongold.task-tree" version "1.5"
}

/*------------------------------------------------------------------------------
  Root project properties
------------------------------------------------------------------------------*/
description = 'Nyx is a portable and flexible semantic release tool.'

allprojects {
    // See: https://docs.gradle.org/current/userguide/base_plugin.html
    apply plugin: 'base'

    /*------------------------------------------------------------------------------
      Project overall attributes
    ------------------------------------------------------------------------------*/
    group   = 'com.mooltiverse.oss.nyx'
    version = '0.0.2-alpha.1'

    // The followings can be removed once we start using the Nyx plugin
    ext.isReleaseVersion = version.matches("^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\$")
    ext.isPrereleaseVersion = version.matches("^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))\$")
}

task test() {
  description 'Runs all tests'
  group 'Verification'
}
tasks.check.dependsOn tasks.test
